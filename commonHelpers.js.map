{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport axios from 'axios';\n\nconst pageForm = document.querySelector(\".form\");\nconst pageLoaderTop = document.querySelector(\".loader-top\");\nconst pageLoaderBottom = document.querySelector(\".loader-bottom\");\nconst pageGallery = document.querySelector(\".gallery\");\nconst pageLoadImg = document.querySelector(\".load-image\");\n\nlet page = 1;\nlet q = \"cat\";\nlet per_page = 15;\n\nconst lightbox = new SimpleLightbox(\".gallery a\", {\n    captionsData: \"alt\",\n    captionDelay: 250,\n    nav: true,\n    close: true,\n    enableKeyboard: true,\n    docClose: true\n    });\n\npageForm.addEventListener(\"submit\", onSubmit);\npageLoadImg.addEventListener(\"click\", loadMore);\n\nasync function onSubmit(event) {\n    event.preventDefault();\n    pageLoaderTop.style.display = \"block\";\n    pageLoadImg.style.display = \"none\";\n    page = 1;\n    q = event.target.elements.search.value.trim();\n    \n    if (!q) {\n    pageGallery.innerHTML = '';\n    iziToast.info({\n        position: \"topRight\",\n        message: `Error enter any symbols`,\n        timeout: 2000,\n    });\n    pageLoaderTop.style.display = \"none\";\n    return;\n    }\n    \n    try {\n    const {\n    data: { hits, totalHits },\n    } = await searchImg(q, page);\n        \n    if (hits.length > 0) {\n    pageLoaderTop.style.display = \"none\";\n    pageGallery.innerHTML = renderImg(hits);\n    lightbox.refresh();\n    iziToast.success({\n    position: \"topRight\",\n    message: `We found ${totalHits} photos`,\n    timeout: 2000,\n    });\n    pageLoadImg.style.display = \"block\";\n    } else {\n    pageGallery.innerHTML = '';\n    iziToast.error({\n        position: \"topRight\",\n        message: `Sorry, there are no images matching your search query. Please try again!`,\n        timeout: 2000,\n    });\n        }\n        \n        if (totalHits <= per_page) {\n            pageLoadImg.style.display = \"none\";\n    }\n    } catch (error) {\n        console.log(\"Error\");\n    } finally {\n        pageLoaderTop.style.display = \"none\";\n        event.target.reset();\n    }\n}\n\nfunction searchImg(q, page) {\n    axios.defaults.baseURL = \"https://pixabay.com\";\n    \n    return axios.get(\"/api/\", {\n        params: {\n            key: \"42179520-d47d5bd3a5ac50ed017a72958\",\n            q,\n            image_type: \"photo\",\n            orientation: \"horizontal\",\n            safesearch: true,\n            page,\n            per_page: 15,\n        },\n    });\n}\n\nfunction renderImg(hits = []) {\n    return hits.reduce((html, hit) => {\n        return (html +\n            `<li class=\"gallery-item\">\n            <a href=${hit.largeImageURL}>\n            <img class=\"gallery-img\" src =${hit.webformatURL} alt=${hit.tags}/>\n            </a>\n            <div class=\"gallery-text-box\">\n            <p>Likes: <span class=\"text-value\">${hit.likes}</span></p>\n            <p>views: <span class=\"text-value\">${hit.views}</span></p>\n            <p>comments: <span class=\"text-value\">${hit.comments}</span></p>\n            <p>downloads: <span class=\"text-value\">${hit.downloads}</span></p>\n            </div>\n            </li>`);\n    }, '');\n}\n\nasync function loadMore(event) {\n    pageLoaderBottom.style.display = \"block\";\n    pageLoadImg.style.display = \"none\";\n    const listItem = document.querySelector(\".gallery-item:first-child\");\n    const itemHeight = listItem.getBoundingClientRect().height;\n    \n    try {\n        page += 1;\n        const { data: { hits, totalHits }, } = await searchImg(q, page);\n        const totalPage = Math.ceil(totalHits / per_page);\n        \n        pageLoadImg.style.display = \"block\";\n        pageGallery.insertAdjacentHTML(\"beforeend\", renderImg(hits));\n        lightbox.refresh();\n    \n        if (page === totalPage) {\n            pageLoadImg.style.display = \"none\";\n            return iziToast.info({\n                position: \"bottomRight\",\n                message: `We're sorry, but you've reached the end of search results.`,\n                timeout: 2500,\n            });\n        }\n    } catch (error) { console.log(error); }\n\n    finally {\n        pageLoaderBottom.style.display = \"none\";\n        window.scrollBy({\n            top: 2 * itemHeight,\n            behavior: \"smooth\",\n        });\n    }\n}"],"names":["pageForm","pageLoaderTop","pageLoaderBottom","pageGallery","pageLoadImg","page","q","per_page","lightbox","SimpleLightbox","onSubmit","loadMore","event","iziToast","hits","totalHits","searchImg","renderImg","axios","html","hit","itemHeight","totalPage","error"],"mappings":"owBAMA,MAAMA,EAAW,SAAS,cAAc,OAAO,EACzCC,EAAgB,SAAS,cAAc,aAAa,EACpDC,EAAmB,SAAS,cAAc,gBAAgB,EAC1DC,EAAc,SAAS,cAAc,UAAU,EAC/CC,EAAc,SAAS,cAAc,aAAa,EAExD,IAAIC,EAAO,EACPC,EAAI,MACJC,EAAW,GAEf,MAAMC,EAAW,IAAIC,EAAe,aAAc,CAC9C,aAAc,MACd,aAAc,IACd,IAAK,GACL,MAAO,GACP,eAAgB,GAChB,SAAU,EACd,CAAK,EAELT,EAAS,iBAAiB,SAAUU,CAAQ,EAC5CN,EAAY,iBAAiB,QAASO,CAAQ,EAE9C,eAAeD,EAASE,EAAO,CAO3B,GANAA,EAAM,eAAc,EACpBX,EAAc,MAAM,QAAU,QAC9BG,EAAY,MAAM,QAAU,OAC5BC,EAAO,EACPC,EAAIM,EAAM,OAAO,SAAS,OAAO,MAAM,OAEnC,CAACN,EAAG,CACRH,EAAY,UAAY,GACxBU,EAAS,KAAK,CACV,SAAU,WACV,QAAS,0BACT,QAAS,GACjB,CAAK,EACDZ,EAAc,MAAM,QAAU,OAC9B,MACC,CAED,GAAI,CACJ,KAAM,CACN,KAAM,CAAE,KAAAa,EAAM,UAAAC,CAAW,CACxB,EAAG,MAAMC,EAAUV,EAAGD,CAAI,EAEvBS,EAAK,OAAS,GAClBb,EAAc,MAAM,QAAU,OAC9BE,EAAY,UAAYc,EAAUH,CAAI,EACtCN,EAAS,QAAO,EAChBK,EAAS,QAAQ,CACjB,SAAU,WACV,QAAS,YAAYE,CAAS,UAC9B,QAAS,GACb,CAAK,EACDX,EAAY,MAAM,QAAU,UAE5BD,EAAY,UAAY,GACxBU,EAAS,MAAM,CACX,SAAU,WACV,QAAS,2EACT,QAAS,GACjB,CAAK,GAGOE,GAAaR,IACbH,EAAY,MAAM,QAAU,OAEnC,MAAe,CACZ,QAAQ,IAAI,OAAO,CAC3B,QAAc,CACNH,EAAc,MAAM,QAAU,OAC9BW,EAAM,OAAO,OAChB,CACL,CAEA,SAASI,EAAUV,EAAGD,EAAM,CACxB,OAAAa,EAAM,SAAS,QAAU,sBAElBA,EAAM,IAAI,QAAS,CACtB,OAAQ,CACJ,IAAK,qCACL,EAAAZ,EACA,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAAD,EACA,SAAU,EACb,CACT,CAAK,CACL,CAEA,SAASY,EAAUH,EAAO,GAAI,CAC1B,OAAOA,EAAK,OAAO,CAACK,EAAMC,IACdD,EACJ;AAAA,sBACUC,EAAI,aAAa;AAAA,4CACKA,EAAI,YAAY,QAAQA,EAAI,IAAI;AAAA;AAAA;AAAA,iDAG3BA,EAAI,KAAK;AAAA,iDACTA,EAAI,KAAK;AAAA,oDACNA,EAAI,QAAQ;AAAA,qDACXA,EAAI,SAAS;AAAA;AAAA,mBAG3D,EAAE,CACT,CAEA,eAAeT,EAASC,EAAO,CAC3BV,EAAiB,MAAM,QAAU,QACjCE,EAAY,MAAM,QAAU,OAE5B,MAAMiB,EADW,SAAS,cAAc,2BAA2B,EACvC,sBAAqB,EAAG,OAEpD,GAAI,CACAhB,GAAQ,EACR,KAAM,CAAE,KAAM,CAAE,KAAAS,EAAM,UAAAC,CAAS,CAAK,EAAG,MAAMC,EAAUV,EAAGD,CAAI,EACxDiB,EAAY,KAAK,KAAKP,EAAYR,CAAQ,EAMhD,GAJAH,EAAY,MAAM,QAAU,QAC5BD,EAAY,mBAAmB,YAAac,EAAUH,CAAI,CAAC,EAC3DN,EAAS,QAAO,EAEZH,IAASiB,EACT,OAAAlB,EAAY,MAAM,QAAU,OACrBS,EAAS,KAAK,CACjB,SAAU,cACV,QAAS,6DACT,QAAS,IACzB,CAAa,CAEb,OAAaU,EAAO,CAAE,QAAQ,IAAIA,CAAK,CAAI,QAE/B,CACJrB,EAAiB,MAAM,QAAU,OACjC,OAAO,SAAS,CACZ,IAAK,EAAImB,EACT,SAAU,QACtB,CAAS,CACJ,CACL"}